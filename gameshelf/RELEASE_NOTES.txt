Game Shelf PWA v1.4.4 Release Notes
=====================================

Release Date: January 30, 2026

WHAT'S NEW POPUP REMOVED:
-------------------------

1. LESS INTRUSIVE UPDATE NOTIFICATIONS:
   - What's New no longer auto-pops up when you log in
   - A badge will still appear on the Help button when there's an update
   - Click Help ‚Üí What's New to see changes at your convenience

---

Game Shelf PWA v1.4.3 Release Notes
=====================================

Release Date: January 30, 2026

HELP BUTTON DEFAULT CHANGE:
---------------------------

1. HELP BUTTON NOW ON BY DEFAULT:
   - New users will see the floating help button (‚ùì) by default
   - Previously defaulted to hidden
   - Users can still toggle it off in Settings if preferred

Also includes Desktop Menu Fix from v1.4.2.

---

Game Shelf PWA v1.4.2 Release Notes
=====================================

Release Date: January 30, 2026

DESKTOP MENU FIX:
-----------------

1. SETTINGS MENU POSITIONING ON DESKTOP:
   - On screens 900px+ wide, the settings menu now appears beside the app
   - Menu slides in to the left of the centered 480px container
   - No longer covers the main app content on desktop
   - Overlay only dims the app area, not the entire screen
   - Falls back to standard slide-over on narrower screens (600-900px)

---

Game Shelf PWA v1.4.1 Release Notes
=====================================

Release Date: January 30, 2026

LEGAL & TERMS UPDATE:
---------------------

1. IMPLICIT TERMS ACKNOWLEDGMENT:
   - Added "By continuing, you agree to our Terms of Service and Privacy Policy"
   - Displayed on the setup welcome screen
   - Links to gameshelf.co/terms and gameshelf.co/privacy
   - Low-friction: continuing through setup = acceptance

2. LEGAL SECTION IN SETTINGS MENU:
   - Added new "Legal" section at bottom of settings menu
   - Links to Terms of Service and Privacy Policy
   - Added third-party disclaimer: "Game Shelf is not affiliated with 
     The New York Times, LinkedIn, or any game publisher."

3. AI HINT DISCLAIMER:
   - Added disclaimer at bottom of hint sheet
   - "Hints are AI-generated and may not always be accurate."
   - "Game Shelf is not affiliated with game publishers."

Note: Terms and Privacy Policy documents created but need to be hosted at:
- gameshelf.co/terms
- gameshelf.co/privacy

---

Game Shelf PWA v1.4.0 Release Notes
=====================================

Release Date: January 30, 2026

URL STRUCTURE CHANGE:
---------------------

**BREAKING CHANGE**: Game Shelf PWA has moved from root to /app/

Old URL: gameshelf.co/
New URL: gameshelf.co/app/

Changes in this release:
1. PWA now lives at /app/ subfolder
2. Landing page moved to root (/) for marketing
3. Updated manifest.json with new scope and start_url
4. Updated FAQ install instructions to reference /app/
5. Service worker updated for new location

Note: Existing PWA installations may need to be reinstalled from the new URL.

---

Game Shelf PWA v1.3.53 Release Notes
=====================================

Release Date: January 30, 2026

DEBUG BUILD:
------------

1. MORNING REVIEW DEBUG LOGGING:
   Added extensive console logging to diagnose why personalized greetings
   aren't being generated. 
   
   Open browser DevTools console and trigger Morning Review to see:
   - What game IDs are being requested
   - What keys exist in appData.stats
   - Full appData.stats contents
   - Yesterday's history data
   - Final userStats object being sent to Firebase
   
   Look for log lines starting with "üåÖ [MR Debug]"

---

Game Shelf PWA v1.3.51 Release Notes
=====================================

Release Date: January 30, 2026

NEW FEATURE:
------------

1. PERSONALIZED MORNING REVIEW GREETING:
   Morning Review now includes a personalized greeting based on your stats!
   
   **How it works:**
   - When you open Morning Review, Game Shelf gathers your recent game stats
   - Stats sent to Firebase include: current streaks, yesterday's scores,
     games played, milestone proximity
   - AI generates a 1-2 sentence personal check-in based on YOUR data
   - Examples: "47-day Wordle streak and counting. Locked in."
              "Wordle in 2 yesterday? Show-off. Let's see an encore."
              "Connections hasn't seen you in 12 days. Just saying."
   
   **Technical details:**
   - Personal greetings are cached per user per day (won't change if reopened)
   - If you have no meaningful stats, shows default: "Let's get the day off 
     to a great start."
   - Displayed in green highlight box between header and daily intro
   - ~100 tokens per generation = negligible cost increase
   
   **New client function:**
   - gatherUserStatsForMorningReview() - collects streak, score, and milestone
     data for all games on user's shelf

---

v1.3.50 (2026-01-30)
--------------------

ENHANCEMENTS:
-------------

1. ENHANCED ANALYTICS FOR BETA:
   Added tracking for key user engagement moments to inform product decisions.
   
   **New events tracked:**
   - morning_review_shown: When Morning Review is displayed (auto vs manual)
   - morning_review_closed: When closed, with engaged=true if content was viewed
   - morning_review_setting: When user enables/disables the feature
   - hint_requested: When AI hint is requested (with game and level)
   - insight_viewed: When post-game insight is opened
   - friend_profile_viewed: When tapping a friend in the widget
   - battle_viewed: When viewing battle details
   - share_action: When sharing to any platform
   - tab_switched: When navigating between tabs
   
   All events include session ID, platform, and app version for analysis.

---

v1.3.49 (2026-01-30)
--------------------

BUG FIXES:

1. HINT GAME SELECTION FIX:
   Fixed bug where wrong game appeared in hint sheet after playing a game.
   
   **Problem:** If you had already recorded Connections today and clicked to 
   play it again, returning to Game Shelf would show Rungs (or another game)
   in the hint sheet instead of Connections.
   
   **Cause:** checkReturnFromGame() was clearing lastLaunchedGame when the 
   game was already logged today. Then hint selection fell back to localStorage
   data from GS Originals like Rungs.
   
   **Fix:** No longer clears lastLaunchedGame when a game is already logged.
   User might want hints even after completing (to review, understand, etc.)

---

v1.3.48 (2026-01-30)
--------------------

1. LOG SHEET MODAL X BUTTON FIX:
   Fixed the X button on the modal not dismissing it.
   
   **Problem:** Clicking the X button did nothing; only tapping outside worked.
   
   **Cause:** closeLogSheet() checked if e.target.id === 'log-sheet', but the X 
   button's target is the button element, not the overlay.
   
   **Fix:** Now also checks for clicks on .bottom-sheet-close elements.

2. PASTE ACTIVITY BUTTON SCROLL FIX:
   Fixed the manual entry modal opening unexpectedly while scrolling.
   
   **Problem:** When scrolling up on the main page, if your finger touched the 
   button for more than 600ms, the modal would pop up.
   
   **Cause:** The button has a long-press (600ms) feature to open manual entry,
   but there was no touchmove handler to cancel it during scrolling.
   
   **Fix:** Added ontouchmove handler which cancels the long-press timer if the 
   user moves their finger (i.e., is scrolling).

UI IMPROVEMENTS:
----------------

3. RENAMED "RECORD GAME" TO "PASTE ACTIVITY":
   The main button now says "Paste Activity" which better reflects that it 
   handles both game results and stats screenshots.
   
   Hint text simplified to: "Tap to paste ‚Ä¢ Hold for manual entry"

4. SIMPLIFIED MANUAL ENTRY MODAL:
   Removed the redundant tabs from the log sheet modal.
   
   **Before:** Modal had two tabs - "Automatic" (paste) and "Manual" (quick log)
   
   **After:** Modal goes straight to manual entry (pick game, select score)
   
   **Rationale:** The "Automatic" paste functionality is already available via 
   the main "Paste Activity" button tap. Long-press is specifically for manual 
   entry, so showing paste options there was redundant.
   
   Modal header now says "‚úèÔ∏è Manual Entry" instead of "üìã Log Game Result"

5. REMOVED REDUNDANT "SHARE TODAY'S RECAP" BUTTON:
   Removed the "Share Today's Recap" button that appeared below Today's Progress.
   
   **Rationale:** The header already has a üì§ share button that does the same 
   thing. Having two buttons was redundant clutter.

6. SIMPLIFIED FRIEND ADDING:
   Streamlined the friend connection flow to use direct links instead of codes.
   
   **Before:** 
   - Share your 8-character referral code
   - Friend enters code in "Add Friend" dialog
   - System looks up referralCodes ‚Üí gets ownerId ‚Üí adds friend
   
   **After:**
   - Tap "Share Friend Link" ‚Üí sends link with your UID
   - Friend taps link ‚Üí instantly connected
   
   **Changes:**
   - Friend link now uses `?friend={uid}` directly (no code lookup)
   - Removed code input field from Add Friend sheet
   - Simplified UI to focus on link sharing
   - Removed token rewards from friend invites (kept for referrals)

7. AI HELP SYSTEM PROMPT OPTIMIZATION:
   Dramatically reduced the AI Help system prompt from 572 lines to 75 lines (87% reduction).
   
   **Why this matters:**
   - Lower API costs (fewer input tokens)
   - Better AI focus (not overwhelmed with info)
   - Navigation buttons now at TOP of prompt (previously buried at line 400+)
   
   **Key change:** NAVIGATION ACTIONS moved to top with clear examples showing
   the [ACTION:function|Label] format. AI should now reliably generate clickable
   navigation buttons.
   
   **What was removed:**
   - Redundant step-by-step guides (info already in feature descriptions)
   - Excessive few-shot examples (kept 4 key ones)
   - Detailed UI explanations (AI can figure these out)
   - Meta information about AI Help itself

8. UNIFIED DATA INPUT - REMOVED SEPARATE "IMPORT STATS" FEATURE:
   Simplified to ONE way to bring data into Game Shelf: the **Paste Activity** button.
   
   **Philosophy:** One button that's smart enough to figure out what you pasted.
   Whether it's a game result, stats screenshot, or share text - Paste Activity
   handles it all.
   
   **Removed:**
   - "üì∑ Import Stats" button from Stats tab
   - "Import Stats from Screenshot" button from game detail sheets  
   - Screenshot import flow in setup wizard (replaced with Paste Activity education)
   
   **Kept:**
   - OCR processing (still works when you paste a screenshot)
   - Stats parsing (auto-detects stats vs game results)
   - All detection logic (just one entry point now)
   
   **Updated FAQ entries:**
   - import-stats, streak-reset, streak-recovery, stats-by-game, stats-mismatch
   - All now describe the unified Paste Activity flow

---

Game Shelf PWA v1.3.47 Release Notes
=====================================

Release Date: January 30, 2026

OCR PAGE SEGMENTATION FIX - STATS NUMBERS NOW DETECTED:
-------------------------------------------------------
Fixed the root cause of stats screenshot parsing failures. Numbers like 
"562 80 1 29" are now correctly detected from Connections and other game stats.

**The Problem:**
Stats screenshots were failing to parse - Tesseract.js wasn't detecting the 
large stat numbers (562, 80, 1, 29) even though labels like "Completed Win% 
Current Streak" were read correctly. Both original and inverted images failed.

**Root Cause:**
Tesseract.js defaults to **PSM 6** (assume uniform block of text) which 
completely misses large standalone numbers. Server-side Tesseract uses 
**PSM 3** (fully automatic) by default, which finds them.

Testing with pytesseract confirmed:
- PSM 3 (AUTO): ‚úÖ Finds "562 80 1 29"
- PSM 4 (SINGLE_COLUMN): ‚úÖ Finds numbers  
- PSM 6 (SINGLE_BLOCK): ‚ùå Numbers missing
- PSM 11/12: ‚úÖ Finds numbers

**Solution:**
Set explicit page segmentation mode when initializing the Tesseract worker:

```javascript
await ocrWorker.setParameters({
    tessedit_pageseg_mode: Tesseract.PSM.AUTO  // PSM 3
});
console.log('üì∑ Tesseract worker initialized with PSM AUTO (3)');
```

**Console Output (working):**
```
üì∑ Tesseract worker initialized with PSM AUTO (3)
üì∑ Original RAW OCR: "... 562 80 1 29 Completed Win% ..."
üì∑ Original score: 85 nums: ['562', '80', '1', '29']
```

**OCR Journey (v1.3.44 ‚Üí v1.3.47):**
- v1.3.44: Try both original/inverted ‚Üí wrong image selected
- v1.3.45: Quality-based scoring ‚Üí both images returned garbage  
- v1.3.46: Debug logging ‚Üí revealed Tesseract getting no numbers
- v1.3.47: Set PSM to AUTO (3) ‚Üí ‚úÖ Numbers detected!

**Files Modified:**
- gameshelf/index.html - PSM configuration, v1.3.47
- gameshelf/sw.js - CACHE_VERSION to v1.3.47

---

Game Shelf PWA v1.3.45 Release Notes
=====================================

Release Date: January 30, 2026

OCR IMAGE SELECTION FIX - DARK MODE SCREENSHOTS:
------------------------------------------------
Fixed an issue where dark mode screenshots (light text on dark background) were
not being processed correctly, even though the inverted version would work.

**The Problem:**
When pasting a dark mode screenshot, the system would try both original and 
inverted images but often selected the wrong one. The original naive selection
logic compared raw number counts, which could be fooled by OCR noise producing
random digits in the wrong image.

**Root Cause:**
The selection logic used simple heuristics (has large number, number count) that
didn't account for OCR quality. A garbage OCR result with random digits could
"win" over a clean inverted result with actual stats numbers.

**Solution - Quality-Based Scoring:**
New `scoreOCRForStats()` function evaluates each OCR result based on:

1. **Stat Keywords** (+10 each): completed/played, win%, current streak, max streak
2. **Valid 4-Number Sequence** (+50): The key pattern [played][%][current][max]
   with validation (win% ‚â§ 100, played ‚â• streaks)  
3. **Large Number Bonus** (+5): Having a number > 100 (games played count)

The image with the higher score is selected, ensuring meaningful stats content
wins over OCR noise.

**Console Output:**
```
üì∑ Original score: 5 nums: ['2', '29', ...]
üì∑ Inverted score: 85 nums: ['562', '80', '1', '29']
üì∑ Using INVERTED (score: 85 > 5)
```

**Files Modified:**
- gameshelf/index.html - New scoring logic in processScreenshot(), v1.3.45
- gameshelf/sw.js - CACHE_VERSION to v1.3.45

---

Game Shelf PWA v1.3.36 Release Notes
=====================================

Release Date: January 29, 2026

SMARTER OCR PROCESSING - ROBUST STATS RECOGNITION:
--------------------------------------------------
Fixed an issue where Connections stats screenshots were not being parsed correctly,
even though the numbers were clearly visible.

**The Problem:**
Standard Connections stats screenshots (showing "562 80 1 29" followed by 
"Completed Win% Current Streak Max Streak") were triggering the "couldn't read 
the numbers clearly" error. The OCR was working, but the parsing logic wasn't 
handling the extracted text properly in all cases.

**Root Causes Identified:**
1. Character confusion: OCR sometimes interprets "1" as "l" (lowercase L) or "I"
2. Character confusion: OCR sometimes interprets "0" as "O" (uppercase O)
3. Layout variations: Browser Tesseract.js may split numbers across lines differently
4. Pattern matching: The "29 Completed" text was incorrectly matching the gamesPlayed
   pattern before the proper 4-number sequence could be found

**Solutions Implemented:**

1. **OCR Text Preprocessing** - New preprocessOCRText() function:
   - Fixes common character confusions (l/I ‚Üí 1, O ‚Üí 0) in number contexts
   - Only applies corrections when characters are adjacent to digits
   - Normalizes whitespace while preserving line structure
   - Logs preprocessing steps for debugging

2. **Aggressive Number Sequence Finder** - New findStatsNumberSequence() function:
   - Multiple strategies to find the 4-number stats sequence
   - Strategy 1: Traditional 4-consecutive-numbers pattern
   - Strategy 2: Keyword proximity - finds numbers before "Completed/Win/Streak"
   - Validates number relationships (played >= streaks, win% <= 100)
   - Prefers later matches to skip status bar times (e.g., "2:29")

3. **Enhanced Debug Logging**:
   - Logs raw OCR output
   - Logs preprocessing transformations  
   - Logs each parsing strategy attempted
   - Logs all number candidates found
   - Makes troubleshooting much easier

MORNING REVIEW BUG FIX:
-----------------------
Fixed "Can't find variable: userData" error that occurred when Morning Review 
tried to access the user's game shelf. Changed incorrect `userData` reference 
to `appData.games.map(g => g.id)`.

**Technical Details:**
- New functions: preprocessOCRText(), findStatsNumberSequence()
- Added Step 3c to parseStatsFromOCR() as final fallback
- Fixed getMorningReviewGames() to use correct variable
- Console logs now provide detailed parsing trace

**Files Modified:**
- gameshelf/index.html - OCR enhancement + Morning Review fix, v1.3.36
- gameshelf/sw.js - CACHE_VERSION to v1.3.36

---

Game Shelf PWA v1.3.35 Release Notes
=====================================

Release Date: January 29, 2026

MORNING REVIEW - AI-POWERED DAILY PREVIEW:
------------------------------------------
New feature that gives users a spoiler-free preview of today's puzzles to build 
excitement before their morning puzzling session.

**How It Works:**
- First login of the day triggers the Morning Review automatically
- AI searches for today's puzzles and generates personalized hype snippets
- Each game gets 1-2 sentences teasing the vibe without spoiling answers
- Content is cached - first user generates, all others get instant results
- Only shows games that are on the user's shelf (personalized)

**Supported Games:**
- NYT: Wordle, Connections, Strands, Mini, Spelling Bee
- LinkedIn: Queens, Pinpoint
- Indies: Quordle, Octordle, Waffle

**UI Features:**
- Beautiful modal with game-by-game snippets
- Overall "vibe rating" (1-5 üå∂Ô∏è emojis)
- Energetic intro and motivational outro
- "Yesterday's Review" option for historical viewing
- Settings toggle to enable/disable
- Quick access in Settings ‚Üí Morning Review ‚Üí View Today's Review

**Technical Details:**
- New Firebase Function: getMorningReview
- Cache structure: morning-review/{date}/meta + games
- 7-day cache retention (vs 2-day for hints)
- Spliced per-user based on shelf games
- Analytics tracking for usage patterns

**Settings:**
- New toggle in Settings submenu: "Show Daily Preview"
- "View Today's Review" link opens modal on demand
- Defaults to enabled for all users


=====================================

Game Shelf PWA v1.3.34 Release Notes
=====================================

Release Date: January 29, 2026

ROBUST OCR ENGINE - FALSE POSITIVE FIX:
---------------------------------------
Critical fix for OCR screenshot parsing that was causing false game detection.

**The Problem:**
When importing a Connections stats screenshot, the app was incorrectly detecting 
it as a Mini Crossword time score. The phone's status bar time (e.g., "2:29") 
was being matched by the overly-greedy Mini parser regex.

**Root Cause:**
The Mini parser regex `(\d+):(\d+)|Mini\s*Crossword` would match ANY time pattern,
including times from the phone's status bar, clocks in screenshots, etc.

**The Fix (Multi-Layer Defense):**

1. **Strict Mini Regex** - Now requires actual Mini context:
   - Must have "Mini Crossword", "The Mini", or "NYT Mini" near the time
   - Bare time patterns like "2:29" are no longer matched
   - Time must be within 50-100 chars of Mini mention

2. **Game Conflict Detection** - Mini parser now rejects if:
   - Text contains "Connections Bot" or "Connections archive"
   - Text contains "current streak...max streak" (stats page indicator)
   - Text contains strong indicators of other games

3. **Stats Page Priority** - Enhanced stats detection:
   - New `isLikelyStatsScreenshot()` function detects stats pages
   - If stats-like but unparseable, shows helpful prompt instead of misdetecting
   - New `detectSplitLineLayout()` handles OCR where numbers and labels are on separate lines

4. **Parse Result Validation** - New validation layer:
   - `validateParseResult()` checks if detected game makes sense given full text
   - Compares game indicators - rejects if stronger indicators for different game
   - Prevents any parser from claiming content that clearly belongs to another game

5. **Sanity Checks** - Additional guardrails:
   - Mini times must be <30 minutes, seconds <60
   - Stats numbers must pass validation (games played > streaks, win% ‚â§100)

**Technical Details:**
- New functions: detectSplitLineLayout(), isLikelyStatsScreenshot(), 
  parseMultipleGamesValidated(), validateParseResult(), showStatsParseFailurePrompt()
- Mini regex changed from greedy pattern to context-requiring pattern
- Added otherGameIndicators blocklist in Mini extract()

**Files Modified:**
- gameshelf/index.html - OCR engine overhaul, v1.3.34
- gameshelf/sw.js - CACHE_VERSION to v1.3.34

---

Game Shelf PWA v1.3.33 Release Notes
=====================================

Release Date: January 29, 2026

SMARTER STATS IMPORT:
---------------------
Complete rewrite of the Import Stats OCR engine for better reliability:

**Intelligent Game Detection:**
- Fuzzy keyword matching - finds game names anywhere in text
- No longer relies on specific phrases like "GUESS DISTRIBUTION"
- Detects "Connections" from "Connections Bot", "Connections archive", etc.
- Works with new/unknown stats page layouts

**Universal Stats Extraction:**
- Pattern-based extraction for common stat terms
- Recognizes: played, completed, win %, streak, max, best, longest
- 4-number layout detection (common stats row pattern)
- Multiple fallback methods for reliability

**Game Picker Fallback:**
- If stats detected but game unknown, prompts user to select
- Shows extracted stats preview before confirming
- Quick selection from games on user's shelf

**Technical Details:**
- STATS_GAME_KEYWORDS: extensible keyword map per game
- UNIVERSAL_STAT_PATTERNS: regex patterns for each stat type  
- detectGameFromText(): fuzzy matching with confidence scores
- detectFourNumberLayout(): heuristic for [played][win%][streak][max] rows
- showGamePickerForStats(): fallback UI when game unknown

---

Game Shelf PWA v1.3.32 Release Notes
=====================================

Release Date: January 29, 2026

AI HELP RAG IMPROVEMENTS (Phase 5):
-----------------------------------
* Increased FAQ context from 3 to 5 results for better AI Help answers
* Added synonym expansion for query matching
  - "sync" now also matches "import", "transfer", "migrate"
  - "balance" now also matches "wallet", "tokens", "coins"
  - And many more common synonyms
* Added category boosting for high-priority FAQ categories
  - Getting Started and Troubleshooting get 2x boost
  - Recording and Streaks get 1.5x boost
* Added FAQ entry for "What's the lightbulb icon?" (Daily Insights)
* Overall: AI Help should now provide more accurate, relevant answers

---

Game Shelf PWA v1.3.30 Release Notes
=====================================

Release Date: January 29, 2026

SHARE TEXT IMPROVEMENTS:
------------------------
* Insight share now uses üß© emoji (matches other share footers)
* Fixed URL to gameshelf.co (was incorrectly gameshelf.app)
* Share format now:
  "Today's Connections (Jan 29) was üéØ FAIR!
   What did you think?
   üß© Tracked with Game Shelf
   gameshelf.co"

ALSO FIXED:
-----------
* All gameshelf.app references updated to gameshelf.co throughout app

---

Game Shelf PWA v1.3.29 Release Notes
=====================================

Release Date: January 29, 2026

BUG FIX - INSIGHT BUTTON LOCATION:
----------------------------------
* "View Today's Insight" button now appears in the "Already Played" sheet
* Previously only showed in long-press menu, now shows when tapping completed game
* Natural flow: see üí° icon ‚Üí tap card ‚Üí see insight option

---

Game Shelf PWA v1.3.28 Release Notes
=====================================

Release Date: January 29, 2026

DAILY INSIGHTS (NEW FEATURE):
-----------------------------
* AI-powered post-puzzle analysis for Connections
* Shows after you log a game - tap the game card to see "View Today's Insight"
* Analysis includes:
  - Difficulty rating (1-5 üî•)
  - Sneakiness level (Low/Medium/High)
  - Category breakdown with traps/red herrings
  - Verdict: was the puzzle fair?

COMMUNITY REACTIONS:
--------------------
* React to insights: üéØ Fair / üôÑ BS / ü§Ø Brutal
* See how other players voted
* "Share Your Take" button to share your reaction

TECHNICAL DETAILS:
------------------
* üí° icon appears on game cards when insight is available
* Firebase functions: getDailyInsight, submitInsightReaction, getInsightReaction
* Cache structure: daily-insights/{date}/{gameId}/
* Reactions stored per-user per-day
* First request triggers AI generation (3-5 seconds)
* Subsequent users get cached version instantly

EXPANSION PLANS:
----------------
Currently Connections only. Can expand to other games based on user feedback.

---

Game Shelf PWA v1.3.27 Release Notes
=====================================

Release Date: January 29, 2026

EXPANDED FAQ SYSTEM:
-------------------
* Expanded FAQ from 48 to 136 questions across 15 categories
* New categories added:
  - Navigation (10 questions)
  - Home Screen (8 questions) 
  - Games Tab (8 questions)
  - AI Help (7 questions)
  - Share Tab (7 questions)
* All existing categories expanded with additional questions
* Improved keyword coverage for better search matching
* All answers verified against actual app functionality

FAQ CATEGORY BREAKDOWN:
-----------------------
1. Getting Started: 10 questions
2. Navigation: 10 questions
3. Home Screen: 8 questions
4. Recording Games: 10 questions
5. Games Tab: 8 questions
6. Streaks & Stats: 12 questions (includes Import Stats)
7. AI Hints: 10 questions
8. AI Help: 7 questions
9. Battles: 11 questions
10. Friends & Social: 8 questions
11. Share Tab: 7 questions
12. Tokens & Coins: 10 questions
13. Account & Sync: 8 questions
14. Troubleshooting: 12 questions
15. Privacy & Data: 5 questions

TECHNICAL DETAILS:
------------------
* FAQ data updated from version 1.0 to 2.0
* JSON structure unchanged (backwards compatible)
* All questions include expanded keyword arrays
* Part of Help Documentation Project Phase 3

---

Game Shelf PWA v1.3.26 Release Notes
=====================================

Release Date: January 29, 2026

TUTORIAL SYSTEM OVERHAUL:
-------------------------
* Fixed tutorial targeting hidden FAB buttons (moved to header)
  - #share-fab ‚Üí #header-share-btn
  - #hint-fab ‚Üí #header-hint-btn
* Fixed .share-hub-header target (didn't exist) ‚Üí .share-results-section
* Fixed #browse-categories - now switches to Discover subtab first
* Fixed desktop positioning - spotlight/card now account for body offset
* Added .tutorial-highlighted class with brightness + purple background
* Properly cleans up highlight class on skip/finish

ACTIVE TAB VISIBILITY:
----------------------
* Increased active tab background opacity from 15% to 25%
* Now clearly visible in dark mode

TECHNICAL DETAILS:
------------------
Desktop positioning fix:
* getBoundingClientRect() returns viewport coords
* With body transform, fixed elements are relative to body
* Now calculates bodyRect offset and subtracts from positioning

Tutorial highlight class:
* filter: brightness(1.4)
* background: rgba(102, 126, 234, 0.25)
* box-shadow: 0 0 20px 5px rgba(102, 126, 234, 0.4)
* z-index: 2001 to appear above overlay

---

Game Shelf PWA v1.3.25 Release Notes
=====================================

Release Date: January 29, 2026

TUTORIAL DARK MODE FIX (ATTEMPT):
---------------------------------
* Added .tutorial-highlighted class to brighten actual target elements
* Uses filter: brightness(1.4) on the element being highlighted
* Class applied via JS when positioning tutorial spotlight
* Class removed when moving between steps or ending tutorial

Note: This was intermediate version - see v1.3.26 for complete fix.

---

Game Shelf PWA v1.3.24 Release Notes
=====================================

Release Date: January 29, 2026

DARK MODE VISIBILITY FIX:
-------------------------
* Tutorial spotlight now has strong inner glow to illuminate dark content
* Added pulsing animation enhancement with brighter glow effect
* Active nav tab now has visible purple background pill (15% opacity)
* Tab background uses border-radius for softer pill shape

TECHNICAL DETAILS:
------------------
Tutorial spotlight CSS changes:
* Added `inset 0 0 20px 5px rgba(102, 126, 234, 0.25)` for inner illumination
* Added stronger outer glow `0 0 30px 8px rgba(102, 126, 234, 0.5)`
* Pulse animation enhanced with brighter 50% state glow

Active nav tab CSS changes:
* Added `background: rgba(102, 126, 234, 0.15)` to .nav-tab.active
* Added `border-radius: 12px` and `margin: 4px 2px` for pill shape
* Added `transition: background 0.2s` for smooth state changes

---

Game Shelf PWA v1.3.23 Release Notes
=====================================

Release Date: January 29, 2026

DESKTOP ENHANCEMENT:
--------------------
* Added desktop containment - app is centered in a 480px container on wide screens
* Desktop side areas now have themed background (dark/light mode aware)
* Added dismissible banner reminding desktop users the app is mobile-first
* Banner only shows once per device (dismissed state saved to localStorage)
* Uses CSS transform trick to contain all fixed-position elements within the app bounds
* No changes to mobile experience - all changes are behind @media (min-width: 600px)

TECHNICAL DETAILS:
------------------
* body gets max-width: 480px and transform: translateX(-50%) on desktop
* This makes position: fixed children relative to body instead of viewport
* html background color adjusts to match light/dark mode
* Desktop banner CSS is display: none on mobile, flex on desktop
* Added isDesktopScreen() helper function
* Platform detection already tracked 'desktop' in analytics

---

Game Shelf PWA v1.3.22 Release Notes
=====================================

Release Date: January 29, 2026

AI HELP IMPROVEMENTS:
--------------------
* AI Help now knows about the Import Stats feature
* Added step-by-step guide for importing existing streaks/stats
* Added FAQ entry: "Can I import my existing streak from Wordle?"
* Added showImportStats navigation action
* Fixed incorrect response that said "Game Shelf can't sync your Wordle streak"

SYSTEM PROMPT UPDATES:
----------------------
* Added "Import Stats from Other Apps" section with steps
* Added few-shot example for import/sync questions
* AI now correctly directs users to Stats ‚Üí By Game ‚Üí Import Stats

---

Game Shelf PWA v1.3.21 Release Notes
=====================================

Release Date: January 29, 2026

UI IMPROVEMENT:
---------------
* Active tab label is now bold for better visibility
* Previously only color changed (purple) - now also font-weight: 700
* Makes it clearer which tab you're currently on

---

Game Shelf PWA v1.3.20 Release Notes
=====================================

Release Date: January 29, 2026

BUG FIX:
--------
* Fixed "Can't find variable: getGameInfo" error in AI Help
* The error occurred when gathering user context for AI requests
* Root cause: Code referenced non-existent getGameInfo() function
* Fix: Changed to use GAMES[gameId] lookup instead

---

Game Shelf PWA v1.3.19 Release Notes
=====================================

Release Date: January 29, 2026

AI NAVIGATION ACTIONS:
----------------------
* AI Help can now provide clickable navigation buttons
* When AI explains how to do something, it includes a button to go there
* Example: "How do I create a battle?" ‚Üí includes [Create Battle ‚Üí] button
* Buttons close AI Help sheet and navigate to the right place

AVAILABLE ACTIONS:
------------------
* Tab navigation (Home, Games, Stats, Battles, Share)
* Subtab navigation (Shelf, Discover, Overview, etc.)
* Open sheets (Create Battle, Add Friend, Wallet, Feedback, etc.)
* Find/open specific games
* Open game hints

TECHNICAL:
----------
* Action token format: [ACTION:functionName:param|Label]
* Token parser in formatAIHelpResponse()
* executeAIHelpAction() handler with 15+ actions
* Event delegation for action button clicks
* Analytics tracking for action usage (ai-help-actions)
* Malformed tokens stripped gracefully

SYSTEM PROMPT:
--------------
* Added NAVIGATION ACTIONS section with available actions
* Added rules for when to include actions
* Added examples with action buttons
* AI only includes action when user wants to DO something

---

Game Shelf PWA v1.3.18 Release Notes
=====================================

Release Date: January 29, 2026

MULTI-TURN AI HELP CONVERSATIONS:
---------------------------------
* AI Help now supports follow-up questions
* First question costs 5 tokens (same as before)
* Up to 3 follow-ups are FREE
* Conversation displayed as chat thread with user/AI bubbles
* "New question" button starts fresh conversation (5 tokens)

UI CHANGES:
-----------
* Redesigned AI Help sheet with conversation thread layout
* User messages shown as purple bubbles (right side)
* AI responses shown as gray bubbles (left side)
* Follow-up input appears after AI responds
* Shows remaining free follow-ups

FIREBASE UPDATES:
-----------------
* getAIHelp function now accepts messages array for context
* Analytics tracks isFollowup and turnCount
* Each turn counts toward daily rate limit (20/day)

TECHNICAL:
----------
* buildContextualPrompt helper function extracted
* Conversation history passed to Claude API
* Max 10 messages in history (safety limit)

---

Game Shelf PWA v1.3.17 Release Notes
=====================================

Release Date: January 29, 2026

AI HELP IMPROVEMENTS:
---------------------
* Added feedback collection (üëç/üëé) after AI responses
* Optional comment field for negative feedback
* Improved system prompt with few-shot examples
* Better handling of vague questions (asks for clarification)
* Updated navigation references for all subtabs

ENHANCED AI CONTEXT:
--------------------
* Passes user's current tab/subtab to AI
* Passes user's shelf games for personalized help
* Passes token balance for hint-related questions
* RAG-lite: Searches FAQ and passes relevant Q&As to AI

FIREBASE UPDATES:
-----------------
* New ai-help-feedback path for feedback storage
* Enhanced analytics with user context

---

Game Shelf PWA v1.3.16 Release Notes
=====================================

Release Date: January 29, 2026

UNIFIED SUBTAB NAVIGATION:
--------------------------
* Added consistent subtab navigation to Games, Stats, and Share tabs
* Matches existing Battles tab pattern for unified UX

GAMES TAB SUBTABS:
------------------
* üìö Shelf - Your games + Recommendations
* üîç Discover - Search + Browse by Category + Suggest

STATS TAB SUBTABS:
------------------
* üìä Overview - Summary cards (Total Games, Streaks, etc.)
* üéÆ By Game - Per-game detailed stats + Import Stats

SHARE TAB SUBTABS:
------------------
* üìÖ Today - Quick share today's results + Friend recommendations
* ‚úèÔ∏è Compose - Full message composer + Templates + All platforms
* üìú History - Past shares (now a dedicated tab, not hidden)

BENEFITS:
---------
* Less scrolling - Content segmented into focused views
* Better discoverability - Features easier to find
* Cleaner first impression - Each subtab shows just what's relevant
* Consistent experience across all main tabs

---

Game Shelf PWA v1.3.15 Release Notes
=====================================

Release Date: January 29, 2026

MENU REORGANIZATION:
--------------------
* Restructured menu for better usability based on access frequency
* Top-level sections now: Account, My Games, Rewards, Help
* Achievements moved into "My Games" section
* Invite Friends + Rewards Shop combined into "Rewards" section
* Help moved higher for easy access
* Settings & Advanced sections are collapsible

VISUAL NAVIGATION CUES:
-----------------------
* Added chevron (‚Ä∫) indicators to menu items that navigate away
* Users can now visually distinguish:
  - Items with ‚Ä∫ = opens a new screen/sheet
  - Items without ‚Ä∫ = action or toggle (stays in menu)

MENU BEHAVIOR IMPROVEMENTS:
---------------------------
* All navigation items now close menu before opening sheet
* Fixed: Sign in/out, Daily Goal, Force Update, Reset Data, Reset Limits
* Consistent 300ms delay for smooth animation

DAILY GOAL PICKER:
------------------
* Replaced browser prompt with visual picker sheet
* Grid of 1-10 buttons for easy selection
* Shows current goal, immediate feedback on tap

---

Game Shelf PWA v1.3.14 Release Notes
=====================================

(Skipped - changes merged into v1.3.15)

---

Game Shelf PWA v1.3.13 Release Notes
=====================================

Release Date: January 29, 2026

LAUNCH PREFERENCES FIX:
-----------------------
* "Manage App vs Browser" in Settings now works properly
* Shows ALL games that support native app launch (NYT, LinkedIn games)
* Previously only showed games with already-saved preferences
* Users can now proactively set app vs browser before playing
* Default is browser, tap any game to toggle

SETTINGS MENU MODAL FIXES:
--------------------------
* All settings that open sheets/modals now close the menu first
* Fixed: Sounds, Launch Prefs, Achievements, Referral, Merch Store, Help
* 300ms delay ensures menu animation completes before opening new sheet
* No more modals appearing behind the settings menu

---

Game Shelf PWA v1.3.12 Release Notes
=====================================

Release Date: January 29, 2026

HELP MODAL TIMING FIX:
----------------------
* All help menu actions (Feedback, Tutorial, About, What's New) now
  wait 350ms for help sheet to close before opening their modal
* Prevents new modals from appearing behind the help sheet

RECONFIGURE GAMES WARNING:
--------------------------
* Added confirmation dialog before starting game setup wizard
* Explains what will happen: add/remove games, change preferences
* Reassures that stats and history are preserved
* User can cancel before proceeding

---

Game Shelf PWA v1.3.11 Release Notes
=====================================

Release Date: January 29, 2026

iOS CLIPBOARD DOCUMENTATION:
----------------------------
* Added iOS note to Auto-Log setting in Settings
  - "‚ö†Ô∏è Not available on iOS due to clipboard restrictions"

* New FAQ: "Why does iOS keep asking to allow paste?"
  - Explains this is a privacy feature, not a bug
  - iOS protects clipboard from silent access
  - Frames it positively (user stays in control)

* New FAQ: "Why doesn't Auto-Log work on my iPhone?"
  - Explains Auto-Log requires silent clipboard access
  - Shows the difference between Android/Desktop vs iOS
  - Validates iOS approach as privacy-respecting

HELP SYSTEM IMPROVEMENTS:
-------------------------
* Added 9 new how-to FAQ entries:
  - How do I get a hint?
  - How do I fix a broken streak?
  - How do I remove a game from my shelf?
  - How do I share my results?
  - How do I sync my data across devices?
  - How do I add a game to my shelf?
  - Expanded: How do I create a battle? (full step-by-step)
  - Expanded: How do I add a friend? (multiple options)
  - Expanded: How do I join a battle? (all methods)

* Fixed all "Hub" references in FAQ and AI Help
  - Now correctly says "Battles tab" with sub-tabs
  - AI Help system prompt completely updated

* AI Help sign-in flow improved
  - No longer kicks user out if not signed in
  - Shows sign-in prompt inline with button
  - User stays in context

* Added "Done" button in AI Help response view
  - Easy exit alongside "Ask another question"

UI CONSISTENCY:
---------------
* Added X close buttons to 8 more modals:
  - Add Friend
  - Profile View
  - Merch Store
  - Activity Summary (Welcome Back)
  - Contact Results
  - Friend Confirm
  - Suggest a Game
  - Quick Capture

* Changed Help "About" icon from üéÆ to ‚ÑπÔ∏è
  - More appropriate info icon

---

Game Shelf PWA v1.3.8 Release Notes
=====================================

Release Date: January 29, 2026

HELP SYSTEM UX OVERHAUL:
------------------------
* Help sheet now fills 92% of screen (was 85vh)
* Compact header: "Help" title left, X button right (single row)
* Bottom actions condensed to 2x2 grid
* FAQ content area now has room to breathe

* Menu properly closes when opening Help
  - Fixed bug where Help was hidden behind settings menu
  - Settings menu now closes before Help sheet opens

X BUTTONS ON ALL MODALS:
------------------------
Added consistent X dismiss buttons to top-right of:
* Log Game Result
* Report Issue / Request
* Account
* Create Battle
* Join Battle
* Battle Details
* Achievements
* Invite Friends

New CSS class .bottom-sheet-close provides consistent styling.

---

Game Shelf PWA v1.3.7 Release Notes
=====================================

Release Date: January 29, 2026

AI HELP UI FIXES:
-----------------
* Much larger response area
  - Sheet height increased from 70vh to 85vh
  - Response area min-height: 300px
  - Font size increased to 15px with better line-height
  - Now 5x more readable

* Fixed "Ask AI" button visibility
  - Button was all white with invisible text
  - Changed from white/var(--primary) to gradient style
  - Now uses linear-gradient(135deg, #667eea, #764ba2) like other buttons
  - Added box-shadow for depth

* Fixed help menu items not clickable
  - Floating help button (purple ?) was blocking clicks
  - Now hides when help sheet is open
  - Re-appears when sheet closes

---

Game Shelf PWA v1.3.6 Release Notes
=====================================

Release Date: January 29, 2026

SHARE HUB IMPROVEMENTS:
-----------------------
* Removed header clutter
  - Removed üì¢ bullhorn icon
  - Removed "Share Hub" title
  - Removed "Write once, share everywhere" tagline
  - More space for actual content

* Larger message composer
  - Textarea rows increased from 4 to 8
  - Min-height increased from 100px to 180px
  - More room to write without scrolling

AI HELP IMPROVEMENTS:
---------------------
* Smarter, more actionable responses
  - Now gives step-by-step instructions
  - Leads with actions, not descriptions
  - Includes numbered steps for multi-step tasks
  
* Added built-in guides for common tasks:
  - Create a Battle (full 6-step walkthrough)
  - Add a Friend
  - Get an AI Hint
  - Record a Game
  - Check Streaks
  - Remove a Game

DEPLOYMENT:
-----------
1. Upload index.js to Command Center (AI Help prompt change)
2. Deploy gameshelf-deploy-v1_3_6.zip

---

Game Shelf PWA v1.3.5 Release Notes
=====================================

Release Date: January 29, 2026

BUG FIX:
--------
* Fixed Help sheet FAQ categories not displaying or expanding
  - Root cause: CSS height conflict between bottom-sheet container and help-sheet-content
  - .help-sheet-content had fixed height: 85vh inside 90vh container with padding
  - This caused flex children to clip incorrectly, especially on iOS
  
* Fix details:
  - Changed .help-sheet-content from height: 85vh to height: 100%
  - Added min-height: 0 to .help-content for proper flex shrinking
  - Set overflow: hidden on help sheet's bottom-sheet container
  - Made bottom-sheet use flex layout for proper height distribution

---

Game Shelf PWA v1.3.4 Release Notes
=====================================

Release Date: January 29, 2026

AI HELP SYSTEM:
---------------
* AI-powered help assistant
  - Ask questions about Game Shelf features, troubleshooting, tips
  - Instant answers powered by Claude AI
  - Conversational interface in dedicated sheet

* Hybrid context (smart context awareness)
  - AI knows what you searched for in FAQs
  - AI knows which FAQ items you expanded
  - More targeted answers based on your journey

* Cost & limits
  - 5 tokens per question
  - 20 questions per day (separate from hint limits)

TECHNICAL:
----------
* New Firebase function: getAIHelp
  - Dedicated function with server-side system prompt
  - Separate rate limiting from hints (20/day)
  - Analytics in ai-help-analytics/

* New Firebase paths:
  - ai-help-usage/{userId}/requests - rate limiting
  - ai-help-analytics/ - usage tracking

* Client changes:
  - New AI Help sheet UI with CSS
  - submitAIHelp() calls getAIHelp function
  - trackViewedFaq() for hybrid context

DEPLOYMENT:
-----------
1. Upload index.js to Command Center
2. Deploy gameshelf-deploy-v1_3_4.zip

---

Game Shelf PWA v1.3.3 Release Notes
=====================================

Release Date: January 29, 2026

HELP SYSTEM:
------------
* New unified Help center
  - Searchable FAQ with 50+ questions
  - 10 categories: Getting Started, Recording, Streaks, Hints, Battles, etc.
  - Search-as-you-type with instant results
  - Basic markdown formatting in answers (bold, code, links)

* Menu consolidation
  - "Help & About" and "Feedback" merged into single "Help" entry
  - What's New, Tutorial, About, and Feedback all accessible from Help sheet
  - Cleaner menu with fewer items

* Floating Help button
  - Former "Feedback" button now opens Help
  - Toggle visibility in Settings ‚Üí Help Button
  - Quick access to FAQs and support

* "Ask AI" preview
  - Button visible in help sheet
  - Full AI help integration coming in future update

* Analytics
  - FAQ views tracked for improvement insights
  - Search queries logged to identify content gaps
  - Ask AI clicks tracked

TECHNICAL:
----------
* FAQ data embedded as JSON in index.html
* Lightweight markdown renderer (no external library)
* Badge system for new FAQ content
* Firebase rules for faq-analytics

---

Game Shelf PWA v1.3.2 Release Notes
=====================================

Release Date: January 29, 2026

WHAT'S NEW FEATURE:
------------------
* Added "What's New" system
  - Automatically shows after app updates
  - Displays new features by version
  - Badge indicator on menu when update unseen
  - Access anytime via Menu ‚Üí Help & About ‚Üí What's New

MENU IMPROVEMENTS:
------------------
* Reorganized menu for better UX
  - Account section moved up for prominence
  - Achievements before Invite Friends (reward before ask)
  - Help & About now includes What's New
  - Feedback moved to bottom

* Better modal dialogs throughout
  - showAbout() now uses styled bottom sheet
  - showMerchDetails() uses styled modals (no more alert/confirm)
  - redeemMerch() shows success modal with gift info
  - Consistent look and feel across the app

CODE QUALITY:
-------------
* New APP_VERSION constant for centralized version management
* RELEASE_NOTES object stores version history
* Version comparison utility (compareVersions)
* localStorage tracking for seen versions

---

Game Shelf PWA v1.3.1 Release Notes
=====================================

Release Date: January 29, 2026

UX IMPROVEMENTS:
----------------
* Quick game buttons now support long-press
  - Consistent with main game grid behavior
  - Long-press quick buttons to access Play/Stats/Remove menu

* Progress section shows CURRENT streak instead of all-time best
  - More relevant for daily motivation
  - Shows highest active streak among your games

* Visual feedback during long-press
  - Game cards now scale and glow purple when holding
  - Users can see they're in "long-press mode"
  - Works on both game grid and quick game buttons

* Friends widget now shows names
  - First name shown below avatar
  - Easier to identify friends at a glance
  - Names truncate gracefully if too long

* Battle widget improvements
  - Now handles multiple active battles (shows most urgent)
  - Shows "(+N more)" when in multiple battles
  - Better time display: hours if <1 day remaining
  - Improved reminder wording: "Still to play:" instead of "Still need:"

* Improved clipboard feedback messages
  - Consistent messaging across all clipboard paths
  - "Not a game result - try copying share text" for unrecognized content
  - Clearer guidance for users

---

Game Shelf PWA v1.3.0 Release Notes
=====================================

Release Date: January 29, 2026

MAJOR NEW FEATURES:
-------------------
* Remove games from shelf
  - Long-press (mobile) or right-click (desktop) any game card
  - Opens game options menu with Play, Stats, and Remove options
  - Confirmation dialog before removal
  - Added "Long-press any game to remove" hint in Your Shelf section
  - Stats and history are preserved when removing games

* Improved game search
  - Search now also matches category names (e.g., "geography" finds all geography games)
  - Search results now show streaks and scores for games on shelf
  - Clicking a shelf game in search now plays it (not just shows "on shelf")
  - Added long-press support in search results

* Better recommendations
  - Refresh button now actually provides variety (added random factor)
  - Sound effect when refreshing

* "Add All" confirmation
  - Bulk adding games now shows confirmation dialog
  - Prevents accidental additions

* Category accordion state persists
  - Expanded categories are remembered across sessions
  - Stored in localStorage

BUG FIXES:
----------
* Quick game buttons now play the game (instead of opening log sheet)
* Sync failure feedback - shows toast after 3 consecutive failures

CODE QUALITY:
-------------
* Added setupLongPress() for touch and context menu handling
* Added showGameOptions() for game card options menu
* Added saveCategoryExpandedState() / restoreCategoryExpandedState()
* Added syncFailureCount tracking

---

Game Shelf PWA v1.2.79 Release Notes
====================================

Release Date: January 29, 2026

CRITICAL BUG FIXES:
-------------------
* Fixed streak calculation - streaks now actually increment!
  - CRITICAL: Previous code set lastPlayed BEFORE checking if it was yesterday
  - This caused the yesterday check to always fail (comparing today === yesterday)
  - Result: streaks could never grow beyond 1
  - Fix: Save oldLastPlayed before updating, use it for comparison
  
* Fixed timezone mismatch in streak calculation
  - yesterdayStr was using UTC (toISOString) while today uses local time
  - Now both use local time consistently
  
* Added proper streak reset logic
  - Streaks now correctly reset to 1 when days are missed
  - Previously there was no reset logic at all

* Fixed 5 additional UTC/local timezone mismatches
  - Added getLocalDateString() helper function for consistent date handling
  - Fixed publishPublicProfile() streak calculation (was UTC, now local)
  - Fixed renderFriendsLeaderboard() streak calculation (was UTC, now local)
  - Fixed loadSentNudges() yesterday calculation (was UTC, now local)
  - Fixed generateActivitySummary() history iteration (was UTC, now local)
  - Fixed calculateStreak() history iteration (was UTC, now local)
  - These bugs could cause incorrect streaks/stats near midnight for users
    in negative UTC offsets (Americas)

NEW FEATURES:
-------------
* Added streak validation on app startup
  - Checks all game streaks when app loads
  - Resets any broken streaks (where lastPlayed is not today or yesterday)
  - Prevents stale streak data from showing in UI
  - Logs reset count to console for debugging

CODE CLEANUP:
-------------
* Removed unused totalGames variable from renderStatsScreen()

---

Game Shelf PWA v1.2.78 Release Notes
=====================================

Release Date: January 29, 2026

SECURITY FIXES:
---------------
* Fixed XSS vulnerability in Share History rendering
  - Share history entries now properly escape platform name and message preview
  - Also escapes date/time strings for defense in depth

BUG FIXES:
----------
* Fixed weekly stats timezone mismatch
  - Weekly recap now uses local dates instead of UTC
  - Matches getTodayString() format for consistent history lookups
  - Fixes issue where late-night plays could be missed in weekly stats

---

Game Shelf PWA v1.2.77 Release Notes
=====================================

Release Date: January 28, 2026

BATTLE SYSTEM FIXES:
--------------------
* Fixed critical double-counting bug
  - Logging same game twice no longer adds to score twice
  - Score now recalculates from all dailyScores (idempotent)
  
* Fixed race condition in rapid game logging
  - Multiple games logged quickly now all count correctly
  - Uses Firebase transactions for atomic updates

* Fixed prize pool calculation for token battles
  - Token stakes now correctly calculate prize pool
  - Was using entryFee (coins only) instead of stakeAmount

* Fixed winner payment currency
  - Coin battle winners now get coins back (not tokens)
  - Token battle winners get tokens back

* Fixed score conflict not updating battles
  - Replacing a score via conflict dialog now updates battle score

* Added battle reminder widget
  - Orange banner shows unplayed battle games: "‚ö†Ô∏è Still need: Wordle, Connections"
  - Clicking opens battle details

* Fixed daysPlayed tracking
  - Now correctly tracks unique days played in battles

NEW BATTLE STAKE UI (v1.2.76):
------------------------------
* Replaced dropdown with three buttons: Friendly | Coins | Tokens
* Coins: 1-5 coins max
* Tokens: 1-500 tokens max
* Simplified warning to single line

SERVER-SIDE SCORING (Firebase Functions):
-----------------------------------------
* New calculateBattleScore trigger recalculates scores authoritatively
* Battle type scoring now applied correctly:
  - Total Score: sum of all raw scores
  - Most Wins: 1 point per win
  - Perfect Hunter: 1 point per perfect score
  - Streak Challenge: raw scores + 10 pts per complete day
* New checkBattleCompletion hourly job auto-completes expired battles

TECHNICAL:
----------
* Client stores dailyMeta with won/perfect flags
* Server trigger recalculates based on battle type
* Firebase transactions prevent race conditions
* Prize distribution respects stakeType (coins vs tokens)

---

Game Shelf PWA v1.2.75 Release Notes
=====================================

Release Date: January 28, 2026

SOUND SYSTEM ENHANCEMENTS:
--------------------------
* Added new sound events:
  - "Coins to Wallet" (walletAdd) - plays when tokens added to wallet
  - "Hint Received" (hint) - plays when AI hint is displayed

* Added new sounds:
  - "Slot Machine Coins" (coinDrop) - cascading coin drop sound
  - "Lightbulb Moment" (lightbulb) - ascending sparkle for hints

* Added sounds to key moments:
  - AI hint received: plays "lightbulb" sound
  - Coin-to-token conversion: plays "coinDrop" sound
  - Five-day streak reward: plays "coinDrop" sound
  - All GS games reward: plays "coinDrop" sound
  - Battle participation tokens: plays "coinDrop" sound
  - Battle prize winnings: plays "coinDrop" sound
  - Referral rewards: plays "coinDrop" sound

---

Game Shelf PWA v1.2.74 Release Notes
=====================================

Release Date: January 28, 2026

BUG FIXES:
----------
* Fixed hint sign-in link not working
  - "Sign in ‚Üí" link in hint sheet now properly triggers Google sign-in
  - Previously it just navigated to the Hub tab
  - All three sign-in prompts in hint flow now work correctly

---

Game Shelf PWA v1.2.73 Release Notes
=====================================

Release Date: January 28, 2026

UX IMPROVEMENTS:
----------------
* Added mute reminder when previewing sounds
  - Shows "No sound? Check if your device is muted" after testing
  - Browsers cannot detect hardware mute state, so this helps users troubleshoot

---

Game Shelf PWA v1.2.72 Release Notes
=====================================

Release Date: January 28, 2026

BUG FIXES:
----------
* Fixed timezone bug in "played today" tracking
  - getTodayString() now uses local time instead of UTC
  - Previously, playing late at night (e.g., 11 PM ET) could record 
    the game as the next day in UTC, causing "already played" to 
    persist incorrectly after midnight local time
  - This affected all daily game tracking in Game Shelf

---

Game Shelf PWA v1.2.71 Release Notes
=====================================

Release Date: January 28, 2026

BUG FIXES:
----------
* Fixed clipboard error toast showing when game actually logs successfully
  - On iOS, "Could not read clipboard" no longer shows incorrectly
  - Clipboard read silently falls back to log sheet if needed
  - Games now log without confusing error messages

* Fixed sound not working on iOS
  - AudioContext now properly created and resumed on first user interaction
  - playSound now async - awaits resume() before playing
  - Added state logging for debugging
  - Sound should play after first tap/click on page

* Improved external game launch experience on iOS PWA
  - First-time tip shows how to return (tap ‚úï or swipe down)
  - Only shows once per device

* Removed "Feedback" banner from top-left corner
  - Banner no longer displays even when Feedback mode is on
  - Feedback button still works when mode is enabled

* Fixed double clipboard permission dialog on Record Game tap
  - Touch devices were triggering both touch and synthesized mouse events
  - Added guard to prevent handleRecordGame() from being called twice

* Menu now stays open when using functions
  - Tapping Sound Customizer, Launch Preferences, etc. no longer closes menu
  - Menu only closes when tapping outside or pressing X

TECHNICAL:
----------
* iOS clipboard handling no longer shows false error toasts
* SoundManager.playSound() and playEvent() now async
* AudioContext created and resumed on first touchstart/click gesture
* Added ensureResumed() method for explicit context resume
* Standalone PWA detection for iOS return navigation tip
* .uat-mode-badge hidden with display:none !important
* recordButtonHandled flag prevents touch+mouse double execution

---

Game Shelf PWA v1.2.69 Release Notes
=====================================

Release Date: January 27, 2026

SECURITY FIXES:
---------------
* Fixed remaining XSS vulnerability in public battles display
  - battle.name now properly escaped with escapeHtml()
  - battle.id escaped with escapeAttr() in onclick handlers

* Added input sanitization at source
  - New sanitizeTextInput() function strips HTML tags and dangerous chars
  - New isValidDisplayName() validator for display name format
  - Battle names sanitized before storing in database

TECHNICAL:
----------
* Defense in depth: escape on input AND output
* Battle name input limited to 30 chars, HTML stripped
* Display name validation: alphanumeric, spaces, basic punctuation only

---

Game Shelf PWA v1.2.68 Release Notes
=====================================

Release Date: January 27, 2026

SECURITY FIXES:
---------------
* Fixed XSS vulnerability in user-generated content display
  - Added escapeHtml() and escapeAttr() sanitization functions
  - 54 total sanitization points across the application
  
* User content areas patched:
  - Contact search results and friend addition
  - Friend cards, lists, and profiles
  - Leaderboard entries
  - Activity feed
  - Profile view headers and actions
  - Battle participants, standings, and results
  - Recommendation cards (challenge/nudge friend)
  - Account modal and menu account section
  - Game search "no results" message
  - Setup image upload preview
  - Battle impact tips

* Defense in depth applied to:
  - All displayName renders
  - All photoURL attributes
  - All onclick handler parameters with user IDs
  - Numeric values sanitized with parseInt()

TECHNICAL:
----------
* All user-controlled strings pass through HTML entity encoding
* URL attributes use attribute-safe encoding
* Numbers use parseInt() before display
* 54 escapeHtml/escapeAttr calls throughout codebase

---

Game Shelf PWA v1.2.67 Release Notes
=====================================

Release Date: January 27, 2026

NEW FEATURES:
-------------
* Reset Purchase Limits - New developer option in Settings
  - Clears purchase history after data reset
  - Allows re-testing the coin purchase flow
  - Only works when wallet is at default state (‚â§50 tokens, 0 coins)
  - Located in Settings ‚Üí Developer section

FIREBASE FUNCTIONS:
-------------------
* Added resetPurchaseHistory Cloud Function
  - Validates wallet state before allowing reset
  - Logs reset actions for audit trail

---

v1.2.66 Release Notes
=====================

Release Date: January 27, 2026

BUG FIXES:
----------
* Added try/catch to coin conversion for safer cloud sync
* Fixed forceRefresh promise chain error handling
* Fixed forceAppUpdate getRegistration error handling
* Fixed loadFromCloud auth restore error handling

TECHNICAL:
----------
* Error handling audit completed
* All async operations now have proper error handling
* Promise chains now have .catch() handlers

---

v1.2.65 Release Notes
=====================

Release Date: January 27, 2026

BUG FIXES:
----------
* Improved Firebase initialization with graceful fallback
  - App no longer crashes if Firebase SDK blocked (e.g., ad blockers)
  - Runs in offline mode when Firebase unavailable
* Fixed all clipboard operations to handle errors properly
  - All copy-to-clipboard now shows error if copy fails
  - Share dialog fallbacks work correctly

TECHNICAL:
----------
* Auth audit completed - all auth state checks consistent
* Promise error handling improved throughout

---

v1.2.64 Release Notes
=====================

BUG FIXES:
----------
* Fixed Transaction History "Sign in required" error when already signed in
  - Was checking wrong variable (window.firebaseUser instead of currentUser)
  - Was using wrong database reference (window.firebaseDB instead of db)

---

v1.2.63 Release Notes
=====================

NEW FEATURES:
-------------
* Transaction History - View your complete wallet activity
  - Coin purchases (amount, cost, date)
  - Token usage (AI hints)
  - Gift redemptions
  - Sorted by date (newest first)
  - Shows last 50 transactions

* Access via: Wallet ‚Üí "üìú Transaction History" button

NOTES:
------
* Requires Firebase Functions with Stripe integration
* Transaction data stored in Firebase Realtime Database
